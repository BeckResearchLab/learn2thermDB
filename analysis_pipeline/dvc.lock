schema: '2.0'
stages:
  protein_alignment_resource_test:
    cmd: python ./analysis_pipeline/t1.4_protein_alignment_resource_test.py
    deps:
    - path: ./analysis_pipeline/t1.4_protein_alignment_resource_test.py
      md5: a0ed6a56ee3a6f7a25e885e705d12be6
      size: 6657
    - path: ./data/taxa/proteins/
      md5: d1c8cfa94113ff9ac352fd400f543432.dir
      size: 24260213045
      nfiles: 16665
    - path: ./data/taxa_pairs/pair_labels.csv
      md5: 93559135b6d41a9a510a775e0236ecfc
      size: 9633344
    - path: ./data/taxa_pairs/pairwise_16s_blast.csv
      md5: aa98b55fec7d0b5a937376b14e094864
      size: 105641139
    - path: ./learn2therm/blast.py
      md5: 1dada75a9efafa27e269ed7285a9c4c0
      size: 31876
    - path: ./learn2therm/utils.py
      md5: 4845b20446345d469e7eae2a6968e962
      size: 1766
    params:
      params.yaml:
        get_protein_blast_scores.blast_metrics:
        - local_gap_compressed_percent_id
        - scaled_local_query_percent_id
        - scaled_local_symmetric_percent_id
        - local_E_value
        - query_align_start
        - query_align_end
        - subject_align_end
        - subject_align_start
        - query_align_len
        - query_align_cov
        - subject_align_len
        - subject_align_cov
        - bit_score
        get_protein_blast_scores.dask_cluster_class: SLURMCluster
        get_protein_blast_scores.max_protein_length: 400
        get_protein_blast_scores.method: diamond
        get_protein_blast_scores.method_blast_params:
          num_threads: 6
          word_size: 3
          gapopen: 11
          gapextend: 1
          matrix: BLOSUM62
          threshold: 11
          ungapped: false
        get_protein_blast_scores.method_diamond_params:
          num_threads: 6
          sensitivity: ultra-sensitive
          iterate: false
          global_ranking:
          gapopen: 11
          gapextend: 1
          matrix: BLOSUM62
        get_protein_blast_scores.n_jobs: 48
    outs:
    - path: ./data/metrics/t1.4_metrics.yaml
      md5: 5d58a021d135f813cfbe2e3a06927094
      size: 303
  protein_alignment_blast_dia_compare:
    cmd: python ./analysis_pipeline/t1.5_protein_alignment_hits_blast_vs_diamond.py
    deps:
    - path: ./analysis_pipeline/t1.5_protein_alignment_hits_blast_vs_diamond.py
      md5: 9dc7565d25bcb6050c4222978fc3cdd5
      size: 8210
    - path: ./data/taxa/proteins/
      md5: d1c8cfa94113ff9ac352fd400f543432.dir
      size: 24260213045
      nfiles: 16665
    - path: ./data/taxa_pairs/pair_labels.csv
      md5: 93559135b6d41a9a510a775e0236ecfc
      size: 9633344
    - path: ./data/taxa_pairs/pairwise_16s_blast.csv
      md5: aa98b55fec7d0b5a937376b14e094864
      size: 105641139
    - path: ./learn2therm/blast.py
      md5: 1dada75a9efafa27e269ed7285a9c4c0
      size: 31876
    - path: ./learn2therm/utils.py
      md5: 4845b20446345d469e7eae2a6968e962
      size: 1766
    params:
      params.yaml:
        get_protein_blast_scores.blast_metrics:
        - local_gap_compressed_percent_id
        - scaled_local_query_percent_id
        - scaled_local_symmetric_percent_id
        - local_E_value
        - query_align_start
        - query_align_end
        - subject_align_end
        - subject_align_start
        - query_align_len
        - query_align_cov
        - subject_align_len
        - subject_align_cov
        - bit_score
        get_protein_blast_scores.dask_cluster_class: SLURMCluster
        get_protein_blast_scores.max_protein_length: 400
        get_protein_blast_scores.method_blast_params:
          num_threads: 6
          word_size: 3
          gapopen: 11
          gapextend: 1
          matrix: BLOSUM62
          threshold: 11
          ungapped: false
        get_protein_blast_scores.method_diamond_params:
          num_threads: 6
          sensitivity: ultra-sensitive
          iterate: false
          global_ranking:
          gapopen: 11
          gapextend: 1
          matrix: BLOSUM62
        get_protein_blast_scores.n_jobs: 48
    outs:
    - path: ./data/analysis/blast_vs_diamond_hits.csv
      md5: c02dd449559e2bdbb1c7a3891a48ad85
      size: 6044
  full_protein_search_space:
    cmd: python ./analysis_pipeline/t0.2_full_protein_search_space.py
    deps:
    - path: ./analysis_pipeline/t0.2_full_protein_search_space.py
      md5: 7a16de25a27f7ab5471edbf535265b9a
      size: 4854
    - path: ./data/metrics/s0.3_protein_per_data_distr.csv
      md5: 00f3a4ce6743ad51fcad580e0b00e586
      size: 118659
    - path: ./data/taxa.parquet
      md5: e62b6a3fbb8232e4dfeca04c863ba761
      size: 6487331
    outs:
    - path: ./data/metrics/t0.2_total_search_space.csv
      md5: 7f7977bf181d72249091ef111175142a
      size: 1625
    - path: ./data/plots/cumsum_proteins.png
      md5: 9c4efbcbc9be7a370702a944f2a33eaa
      size: 114905
    - path: ./data/plots/total_search_space.png
      md5: 153bdef48433ba7f33094e6147ea93b7
      size: 1030643
  chosen_protein_search_space:
    cmd: python ./analysis_pipeline/t1.0_chosen_protein_search_space.py
    deps:
    - path: ./analysis_pipeline/t1.0_chosen_protein_search_space.py
      md5: 11a54caf298cafd7109de85491d4e5f6
      size: 2460
    - path: ./data/metrics/s0.2_protein_per_data_distr.csv
      md5: a8d3ea3b8a2d255cadb284a898bac28d
      size: 117996
    - path: ./data/taxa_thermophile_labels.parquet
      md5: 50bc6d01dae38aefde571ba766851e4f
      size: 120740
    outs:
    - path: ./data/metrics/t1.0_chosen_protein_search_space.yaml
      md5: d2100e79998c9c63163de90461eaf858
      size: 47
    - path: ./data/plots/protein_per_taxa_hist.png
      md5: 2e3075372d3f765593dd5fc633b3541e
      size: 88389
