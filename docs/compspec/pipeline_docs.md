# Pipeline Documentation

This documentation will offer a comprehensive exposition on each script in the pipeline. For a high-level overview instead, see the script [compspecs](../compspec/pipeline_components.md). The purpose, inputs, steps, outputs, metrics, are all described for each pipeline script in this document.

1. `s0.0_get_ncbi_refseq.sh`
   | _Objective_: | _Inputs_: | _Steps in the script_: | _Metrics_: | _Outputs_: |
   |--------------| -----------| ---------------------- | ---------- | ----------|
   | Extract refseq genome data for all bacteria and archaea | There are no parameter inputs in this script as it is used purely for data extraction purposes | <ul><li>The user will input their enviromental account credentials for NCBI.</li> <li>The refseq genome data for both bateria and archaea will be downloaded from NCBI creating subdirectories for each species if necessary.</li></ul> | There are no metrics being stored in this script | The script will generate complete genomic data for all bactera and achaea as an `gbff.gz` file type |

2. `s0.1_get_bacdive_ogt.py`

   _Objective_:

   - Find Optimal Growth Temperature (OGT) associated with each TAXA (organism population) from BacDive
   - Cross-reference TaxID from refseq and use BacDive to get OGT

   _Inputs_:

   The refseq from the previous script will be quered in BacDive to get relevant information

   _Step in the script_:

   a. The user will input their enviromental account credentials for BacDive
   b. Using BacDive, the TAXID (organism) will be used to retrieve an OGT and list of temperatures
   Note:
   In BacDive, an organism can have many growth temperatures as there are many experiments to measure that. As such, the retriving function has many conditionals to parse out what would be the OGT, the optimum growth temperature range, etc.

   c. After that, BacDive will quere the NCBI Taxa to get the OGT, and output a file with the taxID, record, filepath, taxomony, organism as well as the BacDiveID and associated OGT.
   d. Ask evan about filepaths again. #ToDo

   _Metrics_:

   - Length of the TAXA CSV
   - Sum of the TAXA that have a BacDive ID
   - Sum of the TAXA that have an associated OGT of some kind
   - Sum of the TAXA that have an 'optimum' range of postive growth temperatures

   _Outputs_:

   - a CSV for all the quered TAXA generated by BacDive
   - a CSV of the TAXA associated with the proper OGT labels as well as pertient TAXA information from the refseq data (NCBI)

3. `s1.0_label_taxa.py`
   _Objective_:

   Takes all the generated TAXA from the previous script and assign a thermophilic or mesophilic label to them

   _Inputs_:

   The outputs from the previous script so the two CSV TAXA files

   _Step in the script_:

   a. The user will log in to their virtual enviroment from the two previous scripts
   b. The temperatures obtained from the previous script were strings and will be converted to floats. For min-max ranges, the center will be taken
   c. After that, reading from the `params.yaml`
   d.

   _Metrics_:

   _Outputs_:

4. `s1.1_get_protein_sequences.py`
   _Objective_:

   _Inputs_:

   _Step in the script_:

   _Metrics_:

   _Outputs_:

5. `s1.2_get_16s_blast_scores.py`
   _Objective_:

   _Inputs_:

   _Step in the script_:

   _Metrics_:

   _Outputs_:

6. `s1.3_label_all_pairs.py`
   _Objective_:

   _Inputs_:

   _Step in the script_:

   _Metrics_:

   _Outputs_:

7. `s1.4_get_protein_blast_scores.py`
   _Objective_:

   _Inputs_:

   _Step in the script_:

   _Metrics_:

   _Outputs_:
